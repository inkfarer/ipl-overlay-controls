(()=>{"use strict";var e,t={3175:(e,t,n)=>{n.d(t,{Z:()=>a});var i=n(2609),o=n.n(i)()((function(e){return e[1]}));o.push([e.id,"body{margin:0 0 14px}",""]);const a=o},956:(e,t,n)=>{n.d(t,{Z:()=>a});var i=n(2609),o=n.n(i)()((function(e){return e[1]}));o.push([e.id,".title-input[data-v-521d4d21]{width:65%}.duration-input[data-v-521d4d21]{width:35%}",""]);const a=o},6898:(e,t,n)=>{n(223);var i=n(6062),o=n.n(i),a=n(3175);o()(a.Z,{insert:"head",singleton:!1}),a.Z.locals;var r=n(225),l=n(7875);const d=(0,l.Uk)(" The active prediction has not been resolved! "),c={class:"layout horizontal"},u={class:"layout horizontal m-t-4"},s={class:"layout horizontal m-t-8"};var m=n(641),p=n(8127),v=n(9745);const h=nodecg.Replicant("nextRound"),f=[h],g=(0,v.Q_)("nextRound",{state:()=>({nextRound:null}),actions:{setShowOnStream(e){h.value.showOnStream=e},beginNextMatch(e){nodecg.sendMessage("beginNextMatch",e)},setNextRound(e){nodecg.sendMessage("setNextRound",e)}}});var w;!function(e){e.RESOLVED="RESOLVED",e.ACTIVE="ACTIVE",e.CANCELED="CANCELED",e.LOCKED="LOCKED"}(w||(w={}));var y=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{d(i.next(e))}catch(e){a(e)}}function l(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,l)}d((i=i.apply(e,t||[])).next())}))};const b=[nodecg.Replicant("predictionStore")],E=(0,v.Q_)("prediction",{state:()=>({predictionStore:null}),actions:{lockPrediction(){return y(this,void 0,void 0,(function*(){return C(this.predictionStore.currentPrediction,w.LOCKED,[w.ACTIVE])}))},cancelPrediction(){return y(this,void 0,void 0,(function*(){return C(this.predictionStore.currentPrediction,w.CANCELED,[w.ACTIVE,w.LOCKED])}))},resolvePrediction({winningOutcomeIndex:e}){var t;return y(this,void 0,void 0,(function*(){if(e>1||e<0)throw new Error(`Cannot resolve prediction with outcome index ${e}.`);if(!(null===(t=this.predictionStore.currentPrediction)||void 0===t?void 0:t.id))throw new Error("No prediction to resolve.");if(this.predictionStore.currentPrediction.status!==w.LOCKED)throw new Error("Can only resolve a locked prediction.");return nodecg.sendMessage("patchPrediction",{id:this.predictionStore.currentPrediction.id,status:w.RESOLVED,winning_outcome_id:this.predictionStore.currentPrediction.outcomes[e].id})}))},createPrediction({title:e,teamAName:t,teamBName:n,duration:i}){var o;return y(this,void 0,void 0,(function*(){if([w.ACTIVE,w.LOCKED].includes(null===(o=this.predictionStore.currentPrediction)||void 0===o?void 0:o.status))throw new Error("An unresolved prediction already exists.");return nodecg.sendMessage("postPrediction",{title:e,outcomes:[{title:t},{title:n}],prediction_window:i})}))},reconnect(){return y(this,void 0,void 0,(function*(){return nodecg.sendMessage("reconnectToRadiaSocket")}))}}});function C(e,t,n){return y(this,void 0,void 0,(function*(){if(!e||!n.includes(null==e?void 0:e.status))throw new Error(`Cannot set prediction status at this time. Status must match one of [${n.join(", ")}]`);return nodecg.sendMessage("patchPrediction",{id:e.id,status:t})}))}var P=n(6349);function x(e){nodecg.getDialog(e).close()}var V=n(908);const O=(0,l.aZ)({name:"CreatePredictionDialog",components:{IplErrorDisplay:P.Z,IplMessage:p.IplMessage,IplButton:p.IplButton,IplInput:p.IplInput,IplSpace:p.IplSpace,IplDialogTitle:p.IplDialogTitle},setup(){const e=g(),t=E(),n=(0,m.iH)("Who do you think will win this match?"),i=(0,m.iH)(120),o=(0,m.iH)(""),a=(0,m.iH)(""),r={title:(0,p.validator)(n,!0,(0,p.maxLength)(45)),duration:(0,p.validator)(i,!0,(0,p.minValue)(1),(0,p.maxValue)(1800)),"team-a-name":(0,p.validator)(o,!1,(0,p.maxLength)(25)),"team-b-name":(0,p.validator)(a,!1,(0,p.maxLength)(25))};return(0,p.provideValidators)(r),(0,l.YP)((()=>e.nextRound),((e,t)=>{e.teamA.name!==(null==t?void 0:t.teamA.name)&&(o.value=(0,V.f)(e.teamA.name,25)),e.teamB.name!==(null==t?void 0:t.teamB.name)&&(a.value=(0,V.f)(e.teamB.name,25))}),{immediate:!0}),{title:n,duration:i,teamAName:o,teamBName:a,allValid:(0,m.Fl)((()=>(0,p.allValid)(r))),isActivePredictionUnresolved:(0,m.Fl)((()=>{var e;return[w.ACTIVE,w.LOCKED].includes(null===(e=t.predictionStore.currentPrediction)||void 0===e?void 0:e.status)})),createPrediction(){return e=this,r=void 0,d=function*(){yield t.createPrediction({title:n.value,duration:i.value,teamAName:o.value,teamBName:a.value}),nodecg.getDialog("createPredictionDialog").close()},new((l=void 0)||(l=Promise))((function(t,n){function i(e){try{a(d.next(e))}catch(e){n(e)}}function o(e){try{a(d.throw(e))}catch(e){n(e)}}function a(e){var n;e.done?t(e.value):(n=e.value,n instanceof l?n:new l((function(e){e(n)}))).then(i,o)}a((d=d.apply(e,r||[])).next())}));var e,r,l,d},resetInputs(){n.value="Who do you think will win this match?",i.value=120,o.value=e.nextRound.teamA.name,a.value=e.nextRound.teamB.name},closeDialog:x}}});var D=n(956);o()(D.Z,{insert:"head",singleton:!1}),D.Z.locals;const S=(0,n(4407).Z)(O,[["render",function(e,t,n,i,o,a){const r=(0,l.up)("ipl-dialog-title"),m=(0,l.up)("ipl-error-display"),p=(0,l.up)("ipl-message"),v=(0,l.up)("ipl-input"),h=(0,l.up)("ipl-button"),f=(0,l.up)("ipl-space");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(r,{title:"Create Prediction",onClose:t[0]||(t[0]=t=>e.closeDialog("createPredictionDialog"))}),(0,l.Wm)(m,{class:"m-t-8"}),e.isActivePredictionUnresolved?((0,l.wg)(),(0,l.j4)(p,{key:0,type:"warning",class:"m-t-8"},{default:(0,l.w5)((()=>[d])),_:1})):((0,l.wg)(),(0,l.j4)(f,{key:1,class:"m-t-8"},{default:(0,l.w5)((()=>[(0,l._)("div",c,[(0,l.Wm)(v,{modelValue:e.title,"onUpdate:modelValue":t[1]||(t[1]=t=>e.title=t),label:"Title",name:"title",class:"title-input"},null,8,["modelValue"]),(0,l.Wm)(v,{modelValue:e.duration,"onUpdate:modelValue":t[2]||(t[2]=t=>e.duration=t),label:"Duration",extra:"seconds",name:"duration",type:"number",class:"m-l-6 duration-input"},null,8,["modelValue"])]),(0,l._)("div",u,[(0,l.Wm)(v,{modelValue:e.teamAName,"onUpdate:modelValue":t[3]||(t[3]=t=>e.teamAName=t),name:"team-a-name",class:"max-width",label:"Team A"},null,8,["modelValue"]),(0,l.Wm)(v,{modelValue:e.teamBName,"onUpdate:modelValue":t[4]||(t[4]=t=>e.teamBName=t),name:"team-b-name",class:"max-width m-l-6",label:"Team B"},null,8,["modelValue"])]),(0,l._)("div",s,[(0,l.Wm)(h,{label:"Create",disabled:!e.allValid,color:"green",async:"","data-test":"create-prediction-button",onClick:e.createPrediction},null,8,["disabled","onClick"]),(0,l.Wm)(h,{label:"Reset",color:"red",class:"m-l-8","data-test":"reset-inputs-button",onClick:e.resetInputs},null,8,["onClick"])])])),_:1}))],64)}],["__scopeId","data-v-521d4d21"]]);var I,A,N=n(4825),_=n(4928);A=function*(){const e=(0,N.ri)(S);e.use((0,v.WB)()),yield(0,r._)(f,g()),yield(0,r._)(b,E()),(0,_.E)(e),e.mount("#app")},new((I=void 0)||(I=Promise))((function(e,t){function n(e){try{o(A.next(e))}catch(e){t(e)}}function i(e){try{o(A.throw(e))}catch(e){t(e)}}function o(t){var o;t.done?e(t.value):(o=t.value,o instanceof I?o:new I((function(e){e(o)}))).then(n,i)}o((A=A.apply(void 0,[])).next())}))}},n={};function i(e){var o=n[e];if(void 0!==o)return o.exports;var a=n[e]={id:e,loaded:!1,exports:{}};return t[e](a,a.exports,i),a.loaded=!0,a.exports}i.m=t,e=[],i.O=(t,n,o,a)=>{if(!n){var r=1/0;for(u=0;u<e.length;u++){for(var[n,o,a]=e[u],l=!0,d=0;d<n.length;d++)(!1&a||r>=a)&&Object.keys(i.O).every((e=>i.O[e](n[d])))?n.splice(d--,1):(l=!1,a<r&&(r=a));if(l){e.splice(u--,1);var c=o();void 0!==c&&(t=c)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[n,o,a]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={249:0};i.O.j=t=>0===e[t];var t=(t,n)=>{var o,a,[r,l,d]=n,c=0;if(r.some((t=>0!==e[t]))){for(o in l)i.o(l,o)&&(i.m[o]=l[o]);if(d)var u=d(i)}for(t&&t(n);c<r.length;c++)a=r[c],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return i.O(u)},n=self.webpackChunk=self.webpackChunk||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),i.nc=void 0;var o=i.O(void 0,[141,745],(()=>i(6898)));o=i.O(o)})();