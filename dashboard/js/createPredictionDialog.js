(()=>{"use strict";var e,t={3175:(e,t,n)=>{n.d(t,{Z:()=>a});var i=n(2609),o=n.n(i)()((function(e){return e[1]}));o.push([e.id,"body{margin:0 0 14px}",""]);const a=o},3358:(e,t,n)=>{n.d(t,{Z:()=>a});var i=n(2609),o=n.n(i)()((function(e){return e[1]}));o.push([e.id,".title-input[data-v-13cd846a]{width:65%}.duration-input[data-v-13cd846a]{width:35%}",""]);const a=o},1456:(e,t,n)=>{n(223);var i=n(6062),o=n.n(i),a=n(3175);o()(a.Z,{insert:"head",singleton:!1}),a.Z.locals;var r=n(225),l=n(7875);const d=(0,l.Uk)(" The active prediction has not been resolved! "),c={class:"layout horizontal"},u={class:"layout horizontal m-t-4"};var s=n(641),m=n(8127),p=n(243),v=n(9850),h=n.n(v);const f=nodecg.Replicant("nextRound"),g=[f],w=(0,p.MT)({state:{nextRound:null},mutations:{setState(e,{name:t,val:n}){this.state[t]=h()(n)},setShowOnStream(e,t){f.value.showOnStream=t}},actions:{beginNextMatch(e,t){nodecg.sendMessage("beginNextMatch",t)},setNextRound(e,{teamAId:t,teamBId:n,roundId:i}){nodecg.sendMessage("setNextRound",{teamAId:t,teamBId:n,roundId:i})}}}),y=Symbol();var b;!function(e){e.RESOLVED="RESOLVED",e.ACTIVE="ACTIVE",e.CANCELED="CANCELED",e.LOCKED="LOCKED"}(b||(b={}));var E=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{d(i.next(e))}catch(e){a(e)}}function l(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,l)}d((i=i.apply(e,t||[])).next())}))};const P=[nodecg.Replicant("predictionStore")],C=(0,p.MT)({state:{predictionStore:null},mutations:{setState(e,{name:t,val:n}){this.state[t]=h()(n)}},actions:{lockPrediction(e){return E(this,void 0,void 0,(function*(){return S(e.state.predictionStore.currentPrediction,b.LOCKED,[b.ACTIVE])}))},cancelPrediction(e){return E(this,void 0,void 0,(function*(){return S(e.state.predictionStore.currentPrediction,b.CANCELED,[b.ACTIVE,b.LOCKED])}))},resolvePrediction(e,{winningOutcomeIndex:t}){var n;return E(this,void 0,void 0,(function*(){if(t>1||t<0)throw new Error(`Cannot resolve prediction with outcome index ${t}.`);if(!(null===(n=e.state.predictionStore.currentPrediction)||void 0===n?void 0:n.id))throw new Error("No prediction to resolve.");if(e.state.predictionStore.currentPrediction.status!==b.LOCKED)throw new Error("Can only resolve a locked prediction.");return nodecg.sendMessage("patchPrediction",{id:e.state.predictionStore.currentPrediction.id,status:b.RESOLVED,winning_outcome_id:e.state.predictionStore.currentPrediction.outcomes[t].id})}))},createPrediction(e,{title:t,teamAName:n,teamBName:i,duration:o}){var a;return E(this,void 0,void 0,(function*(){if([b.ACTIVE,b.LOCKED].includes(null===(a=e.state.predictionStore.currentPrediction)||void 0===a?void 0:a.status))throw new Error("An unresolved prediction already exists.");return nodecg.sendMessage("postPrediction",{title:t,outcomes:[{title:n},{title:i}],prediction_window:o})}))},reconnect(){return E(this,void 0,void 0,(function*(){return nodecg.sendMessage("reconnectToRadiaSocket")}))}}});function S(e,t,n){return E(this,void 0,void 0,(function*(){if(!e||!n.includes(null==e?void 0:e.status))throw new Error(`Cannot set prediction status at this time. Status must match one of [${n.join(", ")}]`);return nodecg.sendMessage("patchPrediction",{id:e.id,status:t})}))}const x=Symbol();var I=n(6222);function V(e){nodecg.getDialog(e).close()}var O=n(908);const D=(0,l.aZ)({name:"CreatePredictionDialog",components:{IplErrorDisplay:I.Z,IplMessage:m.IplMessage,IplButton:m.IplButton,IplInput:m.IplInput,IplSpace:m.IplSpace,IplDialogTitle:m.IplDialogTitle},setup(){const e=(0,p.oR)(y),t=(0,p.oR)(x),n=(0,s.iH)("Who do you think will win this match?"),i=(0,s.iH)(120),o=(0,s.iH)(""),a=(0,s.iH)(""),r={title:(0,m.validator)(n,!0,(0,m.maxLength)(45)),duration:(0,m.validator)(i,!0,(0,m.minValue)(1),(0,m.maxValue)(1800)),"team-a-name":(0,m.validator)(o,!1,(0,m.maxLength)(25)),"team-b-name":(0,m.validator)(a,!1,(0,m.maxLength)(25))};return(0,m.provideValidators)(r),e.watch((e=>e.nextRound),((e,t)=>{e.teamA.name!==(null==t?void 0:t.teamA.name)&&(o.value=(0,O.f)(e.teamA.name,25)),e.teamB.name!==(null==t?void 0:t.teamB.name)&&(a.value=(0,O.f)(e.teamB.name,25))}),{immediate:!0}),{title:n,duration:i,teamAName:o,teamBName:a,allValid:(0,s.Fl)((()=>(0,m.allValid)(r))),isActivePredictionUnresolved:(0,s.Fl)((()=>{var e;return[b.ACTIVE,b.LOCKED].includes(null===(e=t.state.predictionStore.currentPrediction)||void 0===e?void 0:e.status)})),createPrediction(){return e=this,r=void 0,d=function*(){yield t.dispatch("createPrediction",{title:n.value,duration:i.value,teamAName:o.value,teamBName:a.value}),nodecg.getDialog("createPredictionDialog").close()},new((l=void 0)||(l=Promise))((function(t,n){function i(e){try{a(d.next(e))}catch(e){n(e)}}function o(e){try{a(d.throw(e))}catch(e){n(e)}}function a(e){var n;e.done?t(e.value):(n=e.value,n instanceof l?n:new l((function(e){e(n)}))).then(i,o)}a((d=d.apply(e,r||[])).next())}));var e,r,l,d},closeDialog:V}}});var A=n(3358);o()(A.Z,{insert:"head",singleton:!1}),A.Z.locals;const T=(0,n(4407).Z)(D,[["render",function(e,t,n,i,o,a){const r=(0,l.up)("ipl-dialog-title"),s=(0,l.up)("ipl-error-display"),m=(0,l.up)("ipl-message"),p=(0,l.up)("ipl-input"),v=(0,l.up)("ipl-button"),h=(0,l.up)("ipl-space");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(r,{title:"Create Prediction",onClose:t[0]||(t[0]=t=>e.closeDialog("createPredictionDialog"))}),(0,l.Wm)(s,{class:"m-t-8"}),e.isActivePredictionUnresolved?((0,l.wg)(),(0,l.j4)(m,{key:0,type:"warning",class:"m-t-8"},{default:(0,l.w5)((()=>[d])),_:1})):((0,l.wg)(),(0,l.j4)(h,{key:1,class:"m-t-8"},{default:(0,l.w5)((()=>[(0,l._)("div",c,[(0,l.Wm)(p,{modelValue:e.title,"onUpdate:modelValue":t[1]||(t[1]=t=>e.title=t),label:"Title",name:"title",class:"title-input"},null,8,["modelValue"]),(0,l.Wm)(p,{modelValue:e.duration,"onUpdate:modelValue":t[2]||(t[2]=t=>e.duration=t),label:"Duration",extra:"seconds",name:"duration",type:"number",class:"m-l-6 duration-input"},null,8,["modelValue"])]),(0,l._)("div",u,[(0,l.Wm)(p,{modelValue:e.teamAName,"onUpdate:modelValue":t[3]||(t[3]=t=>e.teamAName=t),name:"team-a-name",class:"max-width",label:"Team A"},null,8,["modelValue"]),(0,l.Wm)(p,{modelValue:e.teamBName,"onUpdate:modelValue":t[4]||(t[4]=t=>e.teamBName=t),name:"team-b-name",class:"max-width m-l-6",label:"Team B"},null,8,["modelValue"])]),(0,l.Wm)(v,{label:"Create",class:"m-t-8",disabled:!e.allValid,color:"green",async:"","data-test":"create-prediction-button",onClick:e.createPrediction},null,8,["disabled","onClick"])])),_:1}))],64)}],["__scopeId","data-v-13cd846a"]]);var N,L,M=n(4825),k=n(4928);L=function*(){yield(0,r.r)(P,C),yield(0,r.r)(g,w);const e=(0,M.ri)(T);(0,k.EW)(e),e.use(C,x),e.use(w,y),e.mount("#app")},new((N=void 0)||(N=Promise))((function(e,t){function n(e){try{o(L.next(e))}catch(e){t(e)}}function i(e){try{o(L.throw(e))}catch(e){t(e)}}function o(t){var o;t.done?e(t.value):(o=t.value,o instanceof N?o:new N((function(e){e(o)}))).then(n,i)}o((L=L.apply(void 0,[])).next())}))}},n={};function i(e){var o=n[e];if(void 0!==o)return o.exports;var a=n[e]={id:e,loaded:!1,exports:{}};return t[e](a,a.exports,i),a.loaded=!0,a.exports}i.m=t,e=[],i.O=(t,n,o,a)=>{if(!n){var r=1/0;for(u=0;u<e.length;u++){for(var[n,o,a]=e[u],l=!0,d=0;d<n.length;d++)(!1&a||r>=a)&&Object.keys(i.O).every((e=>i.O[e](n[d])))?n.splice(d--,1):(l=!1,a<r&&(r=a));if(l){e.splice(u--,1);var c=o();void 0!==c&&(t=c)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[n,o,a]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={249:0};i.O.j=t=>0===e[t];var t=(t,n)=>{var o,a,[r,l,d]=n,c=0;if(r.some((t=>0!==e[t]))){for(o in l)i.o(l,o)&&(i.m[o]=l[o]);if(d)var u=d(i)}for(t&&t(n);c<r.length;c++)a=r[c],i.o(e,a)&&e[a]&&e[a][0](),e[r[c]]=0;return i.O(u)},n=self.webpackChunk=self.webpackChunk||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=i.O(void 0,[36],(()=>i(1456)));o=i.O(o)})();