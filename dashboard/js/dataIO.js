(()=>{var e,a={763:(e,a,t)=>{"use strict";t.d(a,{Z:()=>u});var n=t(9601),o=t.n(n),l=t(2609),r=t.n(l)()(o());r.push([e.id,".section-separator-wrapper{border-color:#869fff;border-radius:7px;padding:8px}.section-separator-wrapper>legend{color:#869fff}",""]);const u=r},4041:(e,a,t)=>{"use strict";t.d(a,{Z:()=>u});var n=t(9601),o=t.n(n),l=t(2609),r=t.n(l)()(o());r.push([e.id,".darker-space{padding:8px;border-radius:5px;background-color:rgba(0,0,0,.15);word-break:break-all}.data-source-selector .ipl-radio__options{padding:0 4px 4px;background-color:rgba(0,0,0,.1);border-radius:5px}",""]);const u=r},5455:(e,a,t)=>{var n=t(6411),o=t(940),l=t(9631),r=t(6152),u=t(7878),d=t(3226),i=t(6001),s=t(7598),c=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(u(e)&&(r(e)||"string"==typeof e||"function"==typeof e.splice||d(e)||s(e)||l(e)))return!e.length;var a=o(e);if("[object Map]"==a||"[object Set]"==a)return!e.size;if(i(e))return!n(e).length;for(var t in e)if(c.call(e,t))return!1;return!0}},9466:(e,a,t)=>{"use strict";t(223);var n=t(225),o=t(4825),l=t(5471),r=function(e,a,t,n){return new(t||(t=Promise))((function(o,l){function r(e){try{d(n.next(e))}catch(e){l(e)}}function u(e){try{d(n.throw(e))}catch(e){l(e)}}function d(e){var a;e.done?o(e.value):(a=e.value,a instanceof t?a:new t((function(e){e(a)}))).then(r,u)}d((n=n.apply(e,a||[])).next())}))};const u=nodecg.Replicant("tournamentData"),d=nodecg.Replicant("roundStore"),i=nodecg.Replicant("matchStore"),s=[u,d,i],c=(0,l.Q_)("tournamentData",{state:()=>({tournamentData:null,roundStore:null,matchStore:null}),actions:{getTournamentData({method:e,id:a}){return r(this,void 0,void 0,(function*(){return nodecg.sendMessage("getTournamentData",{method:e,id:a})}))},getSmashggEvent({eventId:e}){return r(this,void 0,void 0,(function*(){return yield nodecg.sendMessage("getSmashggEvent",{eventId:e})}))},uploadTeamData({file:e}){return r(this,void 0,void 0,(function*(){return m("teams",e)}))},uploadRoundData({file:e}){return r(this,void 0,void 0,(function*(){return m("rounds",e)}))},fetchRoundData({url:e}){return r(this,void 0,void 0,(function*(){return nodecg.sendMessage("getRounds",{url:e})}))},updateRound(e){return r(this,void 0,void 0,(function*(){return nodecg.sendMessage("updateRound",e)}))},insertRound(e){return r(this,void 0,void 0,(function*(){return nodecg.sendMessage("insertRound",e)}))},resetRoundStore(){nodecg.sendMessage("resetRoundStore")},setTeamImageHidden:({teamId:e,isVisible:a})=>nodecg.sendMessage("toggleTeamImage",{teamId:e,isVisible:a}),removeRound:({roundId:e})=>nodecg.sendMessage("removeRound",{roundId:e}),setShortName(e){u.value.meta.shortName=e},refreshTournamentData(){return r(this,void 0,void 0,(function*(){return nodecg.sendMessage("refreshTournamentData")}))}}});function m(e,a){return r(this,void 0,void 0,(function*(){const t=new FormData;t.append("file",a),t.append("jsonType",e);const n=yield fetch("/ipl-overlay-controls/upload-tournament-json",{method:"POST",body:t});if(200!==n.status){const e=yield n.text();throw new Error(`Import failed with status ${n.status}: ${e}`)}}))}var p=t(7875);const h={class:"layout horizontal even-spacing"},v={class:"m-l-8"};var g=t(349);const f={class:"layout horizontal center-horizontal"},b=(0,p._)("div",{class:"title"},"Saved data",-1),S=["href"],y={key:1},I={class:"badge badge-blue m-l-6"},w=(0,p._)("br",null,null,-1),D=(0,p._)("br",null,null,-1);var U,T=t(641),k=t(5455),F=t.n(k);!function(e){e.BATTLEFY="BATTLEFY",e.SMASHGG="SMASHGG",e.UPLOAD="UPLOAD",e.UNKNOWN="UNKNOWN"}(U||(U={}));class N{static toPrettyString(e){return{[U.BATTLEFY]:"Battlefy",[U.SMASHGG]:"Smash.gg",[U.UPLOAD]:"Uploaded file",[U.UNKNOWN]:"Unknown"}[e]}}var V=t(8127);const O={class:"section-separator-wrapper"},M=(0,p.aZ)({name:"BorderedSpace",props:{label:{type:String,required:!0}}});var x=t(6062),C=t.n(x),E=t(4036),R=t.n(E),_=t(6793),A=t.n(_),W=t(7892),P=t.n(W),H=t(1173),L=t.n(H),B=t(2464),Z=t.n(B),j=t(763),G={};G.styleTagTransform=Z(),G.setAttributes=P(),G.insert=A().bind(null,"head"),G.domAPI=R(),G.insertStyleElement=L(),C()(j.Z,G),j.Z&&j.Z.locals&&j.Z.locals;var z=t(4407);const Y=(0,z.Z)(M,[["render",function(e,a,t,n,o,l){return(0,p.wg)(),(0,p.iD)("fieldset",O,[(0,p._)("legend",null,(0,g.zw)(e.label),1),(0,p.WI)(e.$slots,"default")])}]]);var K=function(e,a,t,n){return new(t||(t=Promise))((function(o,l){function r(e){try{d(n.next(e))}catch(e){l(e)}}function u(e){try{d(n.throw(e))}catch(e){l(e)}}function d(e){var a;e.done?o(e.value):(a=e.value,a instanceof t?a:new t((function(e){e(a)}))).then(r,u)}d((n=n.apply(e,a||[])).next())}))};const $=(0,p.aZ)({name:"TeamDataImporter",components:{BorderedSpace:Y,IplCheckbox:V.IplCheckbox,IplUpload:V.IplUpload,IplButton:V.IplButton,IplInput:V.IplInput,IplSelect:V.IplSelect,IplSpace:V.IplSpace,IplRadio:V.IplRadio},setup(){const e=c(),a=(0,p.Fl)((()=>{var e;return!F()(null===(e=nodecg.bundleConfig.smashgg)||void 0===e?void 0:e.apiKey)})),t=(0,T.iH)([]),n=(0,T.iH)(U.BATTLEFY),o=(0,T.iH)(""),l=(0,T.iH)(""),r=(0,T.iH)(null),u=(0,T.iH)(!1),d=(0,T.iH)(""),i=(0,V.validator)(d,!1,V.notBlank),s=(0,T.iH)(!1);(0,p.YP)((()=>e.tournamentData.meta.shortName),(e=>d.value=e),{immediate:!0});const m={"tournament-id-input":(0,V.validator)(o,!1,V.notBlank)};return(0,V.provideValidators)(Object.assign(Object.assign({},m),{shortName:i})),{RIGHT_CLICK_UNDO_MESSAGE:"Right-click to undo changes.",teamDataFile:r,useFileUpload:u,tournamentMetadata:(0,p.Fl)((()=>e.tournamentData.meta)),dataSourceOptions:(0,p.Fl)((()=>[U.BATTLEFY,U.SMASHGG,U.UPLOAD].map((e=>({value:e,name:N.toPrettyString(e),disabled:e===U.SMASHGG&&!a.value}))))),dataSource:n,getDataSourceName:e=>N.toPrettyString(e),idLabel:(0,p.Fl)((()=>{switch(n.value){case U.BATTLEFY:return"Tournament URL";case U.SMASHGG:return"Tournament Slug";case U.UPLOAD:return"Data URL";default:throw new Error(`Unknown tournament data source '${n.value}'`)}})),handleImport(){var a;return K(this,void 0,void 0,(function*(){if(n.value===U.UPLOAD&&u.value)return e.uploadTeamData({file:r.value});{const r=n.value===U.BATTLEFY?function(e){if(e.includes("/")){const a=/^http(s?):\/\//.test(e)?5:3;return e.split("/")[a]}return e}(o.value):o.value,u=yield e.getTournamentData({method:n.value,id:r});(null===(a=null==u?void 0:u.events)||void 0===a?void 0:a.length)>1?(t.value=u.events.map((e=>({name:`${e.name} (${e.game})`,value:e.id.toString()}))),l.value=u.events[0].id.toString()):t.value=[]}}))},handleSmashggEventImport(){return K(this,void 0,void 0,(function*(){yield e.getSmashggEvent({eventId:parseInt(l.value)}),t.value=[]}))},handleSmashggImportCancel(){t.value=[]},allValid:(0,p.Fl)((()=>(0,V.allValid)(m)||u.value&&!!r.value)),tournamentId:o,smashggEvents:t,smashggEvent:l,TournamentDataSource:U,shortName:d,shortNameValidator:i,shortNameChanged:(0,p.Fl)((()=>e.tournamentData.meta.shortName!==d.value)),updateShortName(){e.setShortName(d.value)},undoShortNameChanges(a){var t;a.preventDefault(),d.value=null!==(t=e.tournamentData.meta.shortName)&&void 0!==t?t:e.tournamentData.meta.name},refreshingTournamentData:s,handleRefresh(){return K(this,void 0,void 0,(function*(){s.value=!0;try{yield e.refreshTournamentData()}finally{s.value=!1}}))}}}});var q=t(4041),Q={};Q.styleTagTransform=Z(),Q.setAttributes=P(),Q.insert=A().bind(null,"head"),Q.domAPI=R(),Q.insertStyleElement=L(),C()(q.Z,Q),q.Z&&q.Z.locals&&q.Z.locals;const J=(0,z.Z)($,[["render",function(e,a,t,n,l,r){const u=(0,p.up)("ipl-select"),d=(0,p.up)("ipl-button"),i=(0,p.up)("ipl-radio"),s=(0,p.up)("ipl-input"),c=(0,p.up)("ipl-upload"),m=(0,p.up)("ipl-checkbox"),h=(0,p.up)("ipl-space"),v=(0,p.up)("bordered-space");return(0,p.wg)(),(0,p.j4)(v,{label:"Tournament data"},{default:(0,p.w5)((()=>[(0,p.Wm)(h,null,{default:(0,p.w5)((()=>[e.smashggEvents.length>1?((0,p.wg)(),(0,p.iD)(p.HY,{key:0},[(0,p.Wm)(u,{modelValue:e.smashggEvent,"onUpdate:modelValue":a[0]||(a[0]=a=>e.smashggEvent=a),options:e.smashggEvents,label:"Event"},null,8,["modelValue","options"]),(0,p.Wm)(d,{class:"m-t-8",label:"Import",async:"","progress-message":"Importing...",onClick:e.handleSmashggEventImport},null,8,["onClick"]),(0,p.Wm)(d,{class:"m-t-8",label:"Cancel",color:"red",onClick:e.handleSmashggImportCancel},null,8,["onClick"])],64)):((0,p.wg)(),(0,p.iD)(p.HY,{key:1},[(0,p.Wm)(i,{modelValue:e.dataSource,"onUpdate:modelValue":a[1]||(a[1]=a=>e.dataSource=a),label:"Source",class:"data-source-selector",options:e.dataSourceOptions},null,8,["modelValue","options"]),(0,p.wy)((0,p.Wm)(s,{modelValue:e.tournamentId,"onUpdate:modelValue":a[2]||(a[2]=a=>e.tournamentId=a),label:e.idLabel,name:"tournament-id-input",class:"m-t-4"},null,8,["modelValue","label"]),[[o.F8,e.dataSource!==e.TournamentDataSource.UPLOAD||!e.useFileUpload]]),(0,p.wy)((0,p.Wm)(c,{modelValue:e.teamDataFile,"onUpdate:modelValue":a[3]||(a[3]=a=>e.teamDataFile=a),class:"m-t-8"},null,8,["modelValue"]),[[o.F8,e.dataSource===e.TournamentDataSource.UPLOAD&&e.useFileUpload]]),(0,p._)("div",f,[(0,p.wy)((0,p.Wm)(m,{modelValue:e.useFileUpload,"onUpdate:modelValue":a[4]||(a[4]=a=>e.useFileUpload=a),label:"Upload file",class:"m-t-8",small:""},null,8,["modelValue"]),[[o.F8,e.dataSource===e.TournamentDataSource.UPLOAD]])]),(0,p.Wm)(d,{class:"m-t-8",label:"Import",disabled:!e.allValid||e.refreshingTournamentData,async:"","progress-message":"Importing...",onClick:e.handleImport},null,8,["disabled","onClick"])],64))])),_:1}),(0,p.Wm)(h,{class:"text-center m-t-8"},{default:(0,p.w5)((()=>{var a,t;return[b,e.tournamentMetadata.url?((0,p.wg)(),(0,p.iD)("a",{key:0,href:e.tournamentMetadata.url,target:"_blank"},(0,g.zw)(null!==(a=e.tournamentMetadata.name)&&void 0!==a?a:"No name"),9,S)):((0,p.wg)(),(0,p.iD)("span",y,(0,g.zw)(null!==(t=e.tournamentMetadata.name)&&void 0!==t?t:"No name"),1)),(0,p._)("span",I,(0,g.zw)(e.getDataSourceName(e.tournamentMetadata.source)),1),w,(0,p.Uk)(" "+(0,g.zw)(e.tournamentMetadata.id)+" ",1),e.tournamentMetadata.source===e.TournamentDataSource.SMASHGG?((0,p.wg)(),(0,p.iD)(p.HY,{key:2},[D,(0,p.Uk)(" "+(0,g.zw)(e.tournamentMetadata.sourceSpecificData.smashgg.eventData.name)+" ("+(0,g.zw)(e.tournamentMetadata.sourceSpecificData.smashgg.eventData.game)+") ",1)],64)):(0,p.kq)("",!0),e.tournamentMetadata.source!==e.TournamentDataSource.UPLOAD&&e.tournamentMetadata.source!==e.TournamentDataSource.UNKNOWN?((0,p.wg)(),(0,p.j4)(d,{key:3,class:"m-t-6",label:"Refresh",async:"","progress-message":"Refreshing...",onClick:e.handleRefresh},null,8,["onClick"])):(0,p.kq)("",!0)]})),_:1}),(0,p.Wm)(h,{class:"m-t-8"},{default:(0,p.w5)((()=>[(0,p.Wm)(s,{modelValue:e.shortName,"onUpdate:modelValue":a[5]||(a[5]=a=>e.shortName=a),label:"Short tournament name",name:"shortName"},null,8,["modelValue"]),(0,p.Wm)(d,{class:"m-t-8",label:"Update",color:e.shortNameChanged?"red":"blue",disabled:!e.shortNameValidator.isValid,title:e.RIGHT_CLICK_UNDO_MESSAGE,onClick:e.updateShortName,onRightClick:e.undoShortNameChanges},null,8,["color","disabled","title","onClick","onRightClick"])])),_:1})])),_:1})}]]),X={class:"layout horizontal center-horizontal"};const ee=(0,p.aZ)({name:"RoundImporter",components:{BorderedSpace:Y,IplUpload:V.IplUpload,IplButton:V.IplButton,IplCheckbox:V.IplCheckbox,IplInput:V.IplInput,IplSpace:V.IplSpace},setup(){const e=c(),a=(0,T.iH)(!1),t=(0,T.iH)(null),n=(0,T.iH)(null),o={"round-data-url":(0,V.validator)(n,!1,V.notBlank)};return(0,V.provideValidators)(o),{useFileUpload:a,roundFile:t,dataUrl:n,allValid:(0,p.Fl)((()=>(0,V.allValid)(o))),handleImport(){return o=this,l=void 0,u=function*(){a.value?yield e.uploadRoundData({file:t.value}):yield e.fetchRoundData({url:n.value})},new((r=void 0)||(r=Promise))((function(e,a){function t(e){try{d(u.next(e))}catch(e){a(e)}}function n(e){try{d(u.throw(e))}catch(e){a(e)}}function d(a){var o;a.done?e(a.value):(o=a.value,o instanceof r?o:new r((function(e){e(o)}))).then(t,n)}d((u=u.apply(o,l||[])).next())}));var o,l,r,u}}}}),ae=(0,z.Z)(ee,[["render",function(e,a,t,n,l,r){const u=(0,p.up)("ipl-input"),d=(0,p.up)("ipl-upload"),i=(0,p.up)("ipl-checkbox"),s=(0,p.up)("ipl-button"),c=(0,p.up)("ipl-space"),m=(0,p.up)("bordered-space");return(0,p.wg)(),(0,p.j4)(m,{label:"Round data"},{default:(0,p.w5)((()=>[(0,p.Wm)(c,null,{default:(0,p.w5)((()=>[(0,p.wy)((0,p.Wm)(u,{modelValue:e.dataUrl,"onUpdate:modelValue":a[0]||(a[0]=a=>e.dataUrl=a),name:"round-data-url",label:"Data URL / maps.iplabs.ink URL"},null,8,["modelValue"]),[[o.F8,!e.useFileUpload]]),(0,p.wy)((0,p.Wm)(d,{modelValue:e.roundFile,"onUpdate:modelValue":a[1]||(a[1]=a=>e.roundFile=a)},null,8,["modelValue"]),[[o.F8,e.useFileUpload]]),(0,p._)("div",X,[(0,p.Wm)(i,{modelValue:e.useFileUpload,"onUpdate:modelValue":a[2]||(a[2]=a=>e.useFileUpload=a),small:"",class:"m-t-8",label:"Upload file"},null,8,["modelValue"])]),(0,p.Wm)(s,{label:"Import",class:"m-t-8",async:"","progress-message":"Importing...",disabled:!e.useFileUpload&&!e.allValid||e.useFileUpload&&!e.roundFile,onClick:e.handleImport},null,8,["disabled","onClick"])])),_:1})])),_:1})}]]);var te=t(8942);const ne={class:"text-small text-center"},oe=(0,p.aZ)({name:"MatchExporter",components:{BorderedSpace:Y,IplButton:V.IplButton,IplSpace:V.IplSpace},setup(){const e=c();return{pluralize:V.pluralize,matchCount:(0,p.Fl)((()=>Object.keys(e.matchStore).length)),bundleName:nodecg.bundleName}}}),le=(0,z.Z)(oe,[["render",function(e,a,t,n,o,l){const r=(0,p.up)("ipl-button"),u=(0,p.up)("ipl-space"),d=(0,p.up)("bordered-space");return(0,p.wg)(),(0,p.j4)(d,{label:"Export saved matches"},{default:(0,p.w5)((()=>[(0,p.Wm)(u,null,{default:(0,p.w5)((()=>[(0,p._)("div",ne,"Storing data for "+(0,g.zw)(e.pluralize("match",e.matchCount,"matches")),1),(0,p.Wm)(r,{label:"Export",class:"m-t-4",href:`/${e.bundleName}/match-data`},null,8,["href"])])),_:1})])),_:1})}]]),re=(0,p.aZ)({name:"DataImport",components:{MatchExporter:le,IplErrorDisplay:te.Z,RoundImporter:ae,TeamDataImporter:J}}),ue=(0,z.Z)(re,[["render",function(e,a,t,n,o,l){const r=(0,p.up)("ipl-error-display"),u=(0,p.up)("team-data-importer"),d=(0,p.up)("round-importer"),i=(0,p.up)("match-exporter");return(0,p.wg)(),(0,p.iD)(p.HY,null,[(0,p.Wm)(r,{class:"m-b-8"}),(0,p._)("div",h,[(0,p._)("div",null,[(0,p.Wm)(u)]),(0,p._)("div",v,[(0,p.Wm)(d),(0,p.Wm)(i,{class:"m-t-8"})])])],64)}]]);var de,ie,se=t(4928);ie=function*(){const e=(0,o.ri)(ue);e.use((0,l.WB)()),yield(0,n._)(s,c()),(0,se.E)(e),e.mount("#app")},new((de=void 0)||(de=Promise))((function(e,a){function t(e){try{o(ie.next(e))}catch(e){a(e)}}function n(e){try{o(ie.throw(e))}catch(e){a(e)}}function o(a){var o;a.done?e(a.value):(o=a.value,o instanceof de?o:new de((function(e){e(o)}))).then(t,n)}o((ie=ie.apply(void 0,[])).next())}))}},t={};function n(e){var o=t[e];if(void 0!==o)return o.exports;var l=t[e]={id:e,loaded:!1,exports:{}};return a[e](l,l.exports,n),l.loaded=!0,l.exports}n.m=a,e=[],n.O=(a,t,o,l)=>{if(!t){var r=1/0;for(s=0;s<e.length;s++){for(var[t,o,l]=e[s],u=!0,d=0;d<t.length;d++)(!1&l||r>=l)&&Object.keys(n.O).every((e=>n.O[e](t[d])))?t.splice(d--,1):(u=!1,l<r&&(r=l));if(u){e.splice(s--,1);var i=o();void 0!==i&&(a=i)}}return a}l=l||0;for(var s=e.length;s>0&&e[s-1][2]>l;s--)e[s]=e[s-1];e[s]=[t,o,l]},n.n=e=>{var a=e&&e.__esModule?()=>e.default:()=>e;return n.d(a,{a}),a},n.d=(e,a)=>{for(var t in a)n.o(a,t)&&!n.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:a[t]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,a)=>Object.prototype.hasOwnProperty.call(e,a),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={475:0};n.O.j=a=>0===e[a];var a=(a,t)=>{var o,l,[r,u,d]=t,i=0;if(r.some((a=>0!==e[a]))){for(o in u)n.o(u,o)&&(n.m[o]=u[o]);if(d)var s=d(n)}for(a&&a(t);i<r.length;i++)l=r[i],n.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return n.O(s)},t=self.webpackChunk=self.webpackChunk||[];t.forEach(a.bind(null,0)),t.push=a.bind(null,t.push.bind(t))})(),n.nc=void 0;var o=n.O(void 0,[13,471],(()=>n(9466)));o=n.O(o)})();