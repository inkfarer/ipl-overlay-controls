(()=>{var e,t={5637:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var n=a(2609),o=a.n(n)()((function(e){return e[1]}));o.push([e.id,".section-separator-wrapper{border-color:#869fff;border-radius:7px;padding:8px}.section-separator-wrapper>legend{color:#869fff}",""]);const l=o},276:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var n=a(2609),o=a.n(n)()((function(e){return e[1]}));o.push([e.id,".darker-space{padding:8px;border-radius:5px;background-color:rgba(0,0,0,.15);word-break:break-all}.data-source-selector .ipl-radio__options{padding:0 4px 4px;background-color:rgba(0,0,0,.1);border-radius:5px}",""]);const l=o},5455:(e,t,a)=>{var n=a(6411),o=a(940),l=a(9631),r=a(6152),u=a(7878),d=a(3226),s=a(6001),i=a(7598),c=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(u(e)&&(r(e)||"string"==typeof e||"function"==typeof e.splice||d(e)||i(e)||l(e)))return!e.length;var t=o(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(s(e))return!n(e).length;for(var a in e)if(c.call(e,a))return!1;return!0}},139:(e,t,a)=>{"use strict";a(223);var n=a(225),o=a(4825),l=a(9745),r=function(e,t,a,n){return new(a||(a=Promise))((function(o,l){function r(e){try{d(n.next(e))}catch(e){l(e)}}function u(e){try{d(n.throw(e))}catch(e){l(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(r,u)}d((n=n.apply(e,t||[])).next())}))};const u=nodecg.Replicant("tournamentData"),d=nodecg.Replicant("roundStore"),s=nodecg.Replicant("matchStore"),i=[u,d,s],c=(0,l.Q_)("tournamentData",{state:()=>({tournamentData:null,roundStore:null,matchStore:null}),actions:{getTournamentData({method:e,id:t}){return r(this,void 0,void 0,(function*(){return nodecg.sendMessage("getTournamentData",{method:e,id:t})}))},getSmashggEvent({eventId:e}){return r(this,void 0,void 0,(function*(){return yield nodecg.sendMessage("getSmashggEvent",{eventId:e})}))},uploadTeamData({file:e}){return r(this,void 0,void 0,(function*(){return p("teams",e)}))},uploadRoundData({file:e}){return r(this,void 0,void 0,(function*(){return p("rounds",e)}))},fetchRoundData({url:e}){return r(this,void 0,void 0,(function*(){return nodecg.sendMessage("getRounds",{url:e})}))},updateRound(e){return r(this,void 0,void 0,(function*(){return nodecg.sendMessage("updateRound",e)}))},insertRound(e){return r(this,void 0,void 0,(function*(){return nodecg.sendMessage("insertRound",e)}))},resetRoundStore(){nodecg.sendMessage("resetRoundStore")},setTeamImageHidden:({teamId:e,isVisible:t})=>nodecg.sendMessage("toggleTeamImage",{teamId:e,isVisible:t}),removeRound:({roundId:e})=>nodecg.sendMessage("removeRound",{roundId:e}),setShortName(e){u.value.meta.shortName=e},refreshTournamentData(){return r(this,void 0,void 0,(function*(){return nodecg.sendMessage("refreshTournamentData")}))}}});function p(e,t){return r(this,void 0,void 0,(function*(){const a=new FormData;a.append("file",t),a.append("jsonType",e);const n=yield fetch("/ipl-overlay-controls/upload-tournament-json",{method:"POST",body:a});if(200!==n.status){const e=yield n.text();throw new Error(`Import failed with status ${n.status}: ${e}`)}}))}var m=a(7875);const h={class:"layout horizontal even-spacing"},v={class:"m-l-8"};var g=a(349);const f={class:"layout horizontal center-horizontal"},b=(0,m._)("div",{class:"title"},"Saved data",-1),S=["href"],y={key:1},I={class:"badge badge-blue m-l-6"},w=(0,m._)("br",null,null,-1),D=(0,m._)("br",null,null,-1);var U,k=a(641),T=a(5455),F=a.n(T);!function(e){e.BATTLEFY="BATTLEFY",e.SMASHGG="SMASHGG",e.UPLOAD="UPLOAD",e.UNKNOWN="UNKNOWN"}(U||(U={}));class N{static toPrettyString(e){return{[U.BATTLEFY]:"Battlefy",[U.SMASHGG]:"Smash.gg",[U.UPLOAD]:"Uploaded file",[U.UNKNOWN]:"Unknown"}[e]}}var V=a(8127);const x={class:"section-separator-wrapper"},O=(0,m.aZ)({name:"BorderedSpace",props:{label:{type:String,required:!0}}});var M=a(6062),C=a.n(M),_=a(5637);C()(_.Z,{insert:"head",singleton:!1}),_.Z.locals;var R=a(4407);const E=(0,R.Z)(O,[["render",function(e,t,a,n,o,l){return(0,m.wg)(),(0,m.iD)("fieldset",x,[(0,m._)("legend",null,(0,g.zw)(e.label),1),(0,m.WI)(e.$slots,"default")])}]]);var W=function(e,t,a,n){return new(a||(a=Promise))((function(o,l){function r(e){try{d(n.next(e))}catch(e){l(e)}}function u(e){try{d(n.throw(e))}catch(e){l(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(r,u)}d((n=n.apply(e,t||[])).next())}))};const A=(0,m.aZ)({name:"TeamDataImporter",components:{BorderedSpace:E,IplCheckbox:V.IplCheckbox,IplUpload:V.IplUpload,IplButton:V.IplButton,IplInput:V.IplInput,IplSelect:V.IplSelect,IplSpace:V.IplSpace,IplRadio:V.IplRadio},setup(){const e=c(),t=(0,k.Fl)((()=>{var e;return!F()(null===(e=nodecg.bundleConfig.smashgg)||void 0===e?void 0:e.apiKey)})),a=(0,k.iH)([]),n=(0,k.iH)(U.BATTLEFY),o=(0,k.iH)(""),l=(0,k.iH)(""),r=(0,k.iH)(null),u=(0,k.iH)(!1),d=(0,k.iH)(""),s=(0,V.validator)(d,!1,V.notBlank),i=(0,k.iH)(!1);(0,m.YP)((()=>e.tournamentData.meta.shortName),(e=>d.value=e),{immediate:!0});const p={"tournament-id-input":(0,V.validator)(o,!1,V.notBlank)};return(0,V.provideValidators)(Object.assign(Object.assign({},p),{shortName:s})),{RIGHT_CLICK_UNDO_MESSAGE:"Right-click to undo changes.",teamDataFile:r,useFileUpload:u,tournamentMetadata:(0,k.Fl)((()=>e.tournamentData.meta)),dataSourceOptions:(0,k.Fl)((()=>[U.BATTLEFY,U.SMASHGG,U.UPLOAD].map((e=>({value:e,name:N.toPrettyString(e),disabled:e===U.SMASHGG&&!t.value}))))),dataSource:n,getDataSourceName:e=>N.toPrettyString(e),idLabel:(0,k.Fl)((()=>{switch(n.value){case U.BATTLEFY:return"Tournament URL";case U.SMASHGG:return"Tournament Slug";case U.UPLOAD:return"Data URL";default:throw new Error(`Unknown tournament data source '${n.value}'`)}})),handleImport(){var t;return W(this,void 0,void 0,(function*(){if(n.value===U.UPLOAD&&u.value)return e.uploadTeamData({file:r.value});{const r=n.value===U.BATTLEFY?function(e){if(e.includes("/")){const t=/^http(s?):\/\//.test(e)?5:3;return e.split("/")[t]}return e}(o.value):o.value,u=yield e.getTournamentData({method:n.value,id:r});(null===(t=null==u?void 0:u.events)||void 0===t?void 0:t.length)>1?(a.value=u.events.map((e=>({name:`${e.name} (${e.game})`,value:e.id.toString()}))),l.value=u.events[0].id.toString()):a.value=[]}}))},handleSmashggEventImport(){return W(this,void 0,void 0,(function*(){yield e.getSmashggEvent({eventId:parseInt(l.value)}),a.value=[]}))},handleSmashggImportCancel(){a.value=[]},allValid:(0,k.Fl)((()=>(0,V.allValid)(p)||u.value&&!!r.value)),tournamentId:o,smashggEvents:a,smashggEvent:l,TournamentDataSource:U,shortName:d,shortNameValidator:s,shortNameChanged:(0,k.Fl)((()=>e.tournamentData.meta.shortName!==d.value)),updateShortName(){e.setShortName(d.value)},undoShortNameChanges(t){var a;t.preventDefault(),d.value=null!==(a=e.tournamentData.meta.shortName)&&void 0!==a?a:e.tournamentData.meta.name},refreshingTournamentData:i,handleRefresh(){return W(this,void 0,void 0,(function*(){i.value=!0;try{yield e.refreshTournamentData()}finally{i.value=!1}}))}}}});var H=a(276);C()(H.Z,{insert:"head",singleton:!1}),H.Z.locals;const L=(0,R.Z)(A,[["render",function(e,t,a,n,l,r){const u=(0,m.up)("ipl-select"),d=(0,m.up)("ipl-button"),s=(0,m.up)("ipl-radio"),i=(0,m.up)("ipl-input"),c=(0,m.up)("ipl-upload"),p=(0,m.up)("ipl-checkbox"),h=(0,m.up)("ipl-space"),v=(0,m.up)("bordered-space");return(0,m.wg)(),(0,m.j4)(v,{label:"Tournament data"},{default:(0,m.w5)((()=>[(0,m.Wm)(h,null,{default:(0,m.w5)((()=>[e.smashggEvents.length>1?((0,m.wg)(),(0,m.iD)(m.HY,{key:0},[(0,m.Wm)(u,{modelValue:e.smashggEvent,"onUpdate:modelValue":t[0]||(t[0]=t=>e.smashggEvent=t),options:e.smashggEvents,"data-test":"smashgg-event-selector",label:"Event"},null,8,["modelValue","options"]),(0,m.Wm)(d,{class:"m-t-8",label:"Import",async:"","progress-message":"Importing...","data-test":"smashgg-event-import-button",onClick:e.handleSmashggEventImport},null,8,["onClick"]),(0,m.Wm)(d,{class:"m-t-8",label:"Cancel",color:"red","data-test":"smashgg-event-import-cancel-button",onClick:e.handleSmashggImportCancel},null,8,["onClick"])],64)):((0,m.wg)(),(0,m.iD)(m.HY,{key:1},[(0,m.Wm)(s,{modelValue:e.dataSource,"onUpdate:modelValue":t[1]||(t[1]=t=>e.dataSource=t),label:"Source","data-test":"source-selector",class:"data-source-selector",options:e.dataSourceOptions},null,8,["modelValue","options"]),(0,m.wy)((0,m.Wm)(i,{modelValue:e.tournamentId,"onUpdate:modelValue":t[2]||(t[2]=t=>e.tournamentId=t),label:e.idLabel,name:"tournament-id-input",class:"m-t-4"},null,8,["modelValue","label"]),[[o.F8,e.dataSource!==e.TournamentDataSource.UPLOAD||!e.useFileUpload]]),(0,m.wy)((0,m.Wm)(c,{modelValue:e.teamDataFile,"onUpdate:modelValue":t[3]||(t[3]=t=>e.teamDataFile=t),class:"m-t-8","data-test":"team-data-upload"},null,8,["modelValue"]),[[o.F8,e.dataSource===e.TournamentDataSource.UPLOAD&&e.useFileUpload]]),(0,m._)("div",f,[(0,m.wy)((0,m.Wm)(p,{modelValue:e.useFileUpload,"onUpdate:modelValue":t[4]||(t[4]=t=>e.useFileUpload=t),label:"Upload file",class:"m-t-8",small:"","data-test":"use-file-upload-checkbox"},null,8,["modelValue"]),[[o.F8,e.dataSource===e.TournamentDataSource.UPLOAD]])]),(0,m.Wm)(d,{class:"m-t-8",label:"Import",disabled:!e.allValid||e.refreshingTournamentData,async:"","progress-message":"Importing...","data-test":"import-button",onClick:e.handleImport},null,8,["disabled","onClick"])],64))])),_:1}),(0,m.Wm)(h,{"data-test":"saved-data-section",class:"text-center m-t-8"},{default:(0,m.w5)((()=>{var t,a;return[b,e.tournamentMetadata.url?((0,m.wg)(),(0,m.iD)("a",{key:0,href:e.tournamentMetadata.url,target:"_blank"},(0,g.zw)(null!==(t=e.tournamentMetadata.name)&&void 0!==t?t:"No name"),9,S)):((0,m.wg)(),(0,m.iD)("span",y,(0,g.zw)(null!==(a=e.tournamentMetadata.name)&&void 0!==a?a:"No name"),1)),(0,m._)("span",I,(0,g.zw)(e.getDataSourceName(e.tournamentMetadata.source)),1),w,(0,m.Uk)(" "+(0,g.zw)(e.tournamentMetadata.id)+" ",1),e.tournamentMetadata.source===e.TournamentDataSource.SMASHGG?((0,m.wg)(),(0,m.iD)(m.HY,{key:2},[D,(0,m.Uk)(" "+(0,g.zw)(e.tournamentMetadata.sourceSpecificData.smashgg.eventData.name)+" ("+(0,g.zw)(e.tournamentMetadata.sourceSpecificData.smashgg.eventData.game)+") ",1)],64)):(0,m.kq)("",!0),e.tournamentMetadata.source!==e.TournamentDataSource.UPLOAD&&e.tournamentMetadata.source!==e.TournamentDataSource.UNKNOWN?((0,m.wg)(),(0,m.j4)(d,{key:3,class:"m-t-6",label:"Refresh",async:"","progress-message":"Refreshing...","data-test":"refresh-button",onClick:e.handleRefresh},null,8,["onClick"])):(0,m.kq)("",!0)]})),_:1}),(0,m.Wm)(h,{class:"m-t-8"},{default:(0,m.w5)((()=>[(0,m.Wm)(i,{modelValue:e.shortName,"onUpdate:modelValue":t[5]||(t[5]=t=>e.shortName=t),label:"Short tournament name",name:"shortName"},null,8,["modelValue"]),(0,m.Wm)(d,{class:"m-t-8",label:"Update","data-test":"update-short-name-button",color:e.shortNameChanged?"red":"blue",disabled:!e.shortNameValidator.isValid,title:e.RIGHT_CLICK_UNDO_MESSAGE,onClick:e.updateShortName,onRightClick:e.undoShortNameChanges},null,8,["color","disabled","title","onClick","onRightClick"])])),_:1})])),_:1})}]]),P={class:"layout horizontal center-horizontal"};const B=(0,m.aZ)({name:"RoundImporter",components:{BorderedSpace:E,IplUpload:V.IplUpload,IplButton:V.IplButton,IplCheckbox:V.IplCheckbox,IplInput:V.IplInput,IplSpace:V.IplSpace},setup(){const e=c(),t=(0,k.iH)(!1),a=(0,k.iH)(null),n=(0,k.iH)(null),o={"round-data-url":(0,V.validator)(n,!1,V.notBlank)};return(0,V.provideValidators)(o),{useFileUpload:t,roundFile:a,dataUrl:n,allValid:(0,k.Fl)((()=>(0,V.allValid)(o))),handleImport(){return o=this,l=void 0,u=function*(){t.value?yield e.uploadRoundData({file:a.value}):yield e.fetchRoundData({url:n.value})},new((r=void 0)||(r=Promise))((function(e,t){function a(e){try{d(u.next(e))}catch(e){t(e)}}function n(e){try{d(u.throw(e))}catch(e){t(e)}}function d(t){var o;t.done?e(t.value):(o=t.value,o instanceof r?o:new r((function(e){e(o)}))).then(a,n)}d((u=u.apply(o,l||[])).next())}));var o,l,r,u}}}}),j=(0,R.Z)(B,[["render",function(e,t,a,n,l,r){const u=(0,m.up)("ipl-input"),d=(0,m.up)("ipl-upload"),s=(0,m.up)("ipl-checkbox"),i=(0,m.up)("ipl-button"),c=(0,m.up)("ipl-space"),p=(0,m.up)("bordered-space");return(0,m.wg)(),(0,m.j4)(p,{label:"Round data"},{default:(0,m.w5)((()=>[(0,m.Wm)(c,null,{default:(0,m.w5)((()=>[(0,m.wy)((0,m.Wm)(u,{modelValue:e.dataUrl,"onUpdate:modelValue":t[0]||(t[0]=t=>e.dataUrl=t),name:"round-data-url",label:"Data URL"},null,8,["modelValue"]),[[o.F8,!e.useFileUpload]]),(0,m.wy)((0,m.Wm)(d,{modelValue:e.roundFile,"onUpdate:modelValue":t[1]||(t[1]=t=>e.roundFile=t),"data-test":"round-file-upload"},null,8,["modelValue"]),[[o.F8,e.useFileUpload]]),(0,m._)("div",P,[(0,m.Wm)(s,{modelValue:e.useFileUpload,"onUpdate:modelValue":t[2]||(t[2]=t=>e.useFileUpload=t),small:"",class:"m-t-8",label:"Upload file","data-test":"use-file-upload-checkbox"},null,8,["modelValue"])]),(0,m.Wm)(i,{label:"Import",class:"m-t-8",async:"","progress-message":"Importing...","data-test":"import-button",disabled:!e.useFileUpload&&!e.allValid||e.useFileUpload&&!e.roundFile,onClick:e.handleImport},null,8,["disabled","onClick"])])),_:1})])),_:1})}]]);var G=a(6349);const z={class:"text-small text-center"},Z=(0,m.aZ)({name:"MatchExporter",components:{BorderedSpace:E,IplButton:V.IplButton,IplSpace:V.IplSpace},setup(){const e=c();return{pluralize:V.pluralize,matchCount:(0,k.Fl)((()=>Object.keys(e.matchStore).length)),bundleName:nodecg.bundleName}}}),Y=(0,R.Z)(Z,[["render",function(e,t,a,n,o,l){const r=(0,m.up)("ipl-button"),u=(0,m.up)("ipl-space"),d=(0,m.up)("bordered-space");return(0,m.wg)(),(0,m.j4)(d,{label:"Export saved matches"},{default:(0,m.w5)((()=>[(0,m.Wm)(u,null,{default:(0,m.w5)((()=>[(0,m._)("div",z,"Storing data for "+(0,g.zw)(e.pluralize("match",e.matchCount,"matches")),1),(0,m.Wm)(r,{label:"Export",class:"m-t-4",href:`/${e.bundleName}/match-data`},null,8,["href"])])),_:1})])),_:1})}]]),K=(0,m.aZ)({name:"DataImport",components:{MatchExporter:Y,IplErrorDisplay:G.Z,RoundImporter:j,TeamDataImporter:L}}),$=(0,R.Z)(K,[["render",function(e,t,a,n,o,l){const r=(0,m.up)("ipl-error-display"),u=(0,m.up)("team-data-importer"),d=(0,m.up)("round-importer"),s=(0,m.up)("match-exporter");return(0,m.wg)(),(0,m.iD)(m.HY,null,[(0,m.Wm)(r,{class:"m-b-8"}),(0,m._)("div",h,[(0,m._)("div",null,[(0,m.Wm)(u)]),(0,m._)("div",v,[(0,m.Wm)(d),(0,m.Wm)(s,{class:"m-t-8"})])])],64)}]]);var q,Q,J=a(4928);Q=function*(){const e=(0,o.ri)($);e.use((0,l.WB)()),yield(0,n._)(i,c()),(0,J.E)(e),e.mount("#app")},new((q=void 0)||(q=Promise))((function(e,t){function a(e){try{o(Q.next(e))}catch(e){t(e)}}function n(e){try{o(Q.throw(e))}catch(e){t(e)}}function o(t){var o;t.done?e(t.value):(o=t.value,o instanceof q?o:new q((function(e){e(o)}))).then(a,n)}o((Q=Q.apply(void 0,[])).next())}))}},a={};function n(e){var o=a[e];if(void 0!==o)return o.exports;var l=a[e]={id:e,loaded:!1,exports:{}};return t[e](l,l.exports,n),l.loaded=!0,l.exports}n.m=t,e=[],n.O=(t,a,o,l)=>{if(!a){var r=1/0;for(i=0;i<e.length;i++){for(var[a,o,l]=e[i],u=!0,d=0;d<a.length;d++)(!1&l||r>=l)&&Object.keys(n.O).every((e=>n.O[e](a[d])))?a.splice(d--,1):(u=!1,l<r&&(r=l));if(u){e.splice(i--,1);var s=o();void 0!==s&&(t=s)}}return t}l=l||0;for(var i=e.length;i>0&&e[i-1][2]>l;i--)e[i]=e[i-1];e[i]=[a,o,l]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={475:0};n.O.j=t=>0===e[t];var t=(t,a)=>{var o,l,[r,u,d]=a,s=0;if(r.some((t=>0!==e[t]))){for(o in u)n.o(u,o)&&(n.m[o]=u[o]);if(d)var i=d(n)}for(t&&t(a);s<r.length;s++)l=r[s],n.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return n.O(i)},a=self.webpackChunk=self.webpackChunk||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})(),n.nc=void 0;var o=n.O(void 0,[141,745],(()=>n(139)));o=n.O(o)})();