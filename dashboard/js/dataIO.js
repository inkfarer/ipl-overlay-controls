(()=>{var e,t={4460:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var n=a(2609),o=a.n(n)()((function(e){return e[1]}));o.push([e.id,".existing-data[data-v-c6c53654]{padding:8px;border-radius:5px;background-color:#181e29;text-align:center;word-break:break-all}",""]);const r=o},343:e=>{e.exports=function(e,t){for(var a=-1,n=null==e?0:e.length,o=Array(n);++a<n;)o[a]=t(e[a],a,e);return o}},217:e=>{e.exports=function(e){return e.split("")}},1359:e=>{e.exports=function(e,t,a,n){for(var o=e.length,r=a+(n?1:-1);n?r--:++r<o;)if(t(e[r],r,e))return r;return-1}},7832:(e,t,a)=>{var n=a(1359),o=a(2195),r=a(6024);e.exports=function(e,t,a){return t==t?r(e,t,a):n(e,o,a)}},2195:e=>{e.exports=function(e){return e!=e}},9872:e=>{e.exports=function(e,t,a){var n=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(a=a>o?o:a)<0&&(a+=o),o=t>a?0:a-t>>>0,t>>>=0;for(var r=Array(o);++n<o;)r[n]=e[n+t];return r}},1054:(e,t,a)=>{var n=a(857),o=a(343),r=a(6152),l=a(4795),u=n?n.prototype:void 0,i=u?u.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(r(t))return o(t,e)+"";if(l(t))return i?i.call(t):"";var a=t+"";return"0"==a&&1/t==-1/0?"-0":a}},1704:(e,t,a)=>{var n=a(2153),o=/^\s+/;e.exports=function(e){return e?e.slice(0,n(e)+1).replace(o,""):e}},3895:(e,t,a)=>{var n=a(9872);e.exports=function(e,t,a){var o=e.length;return a=void 0===a?o:a,!t&&a>=o?e:n(e,t,a)}},768:(e,t,a)=>{var n=a(7832);e.exports=function(e,t){for(var a=e.length;a--&&n(t,e[a],0)>-1;);return a}},1821:(e,t,a)=>{var n=a(7832);e.exports=function(e,t){for(var a=-1,o=e.length;++a<o&&n(t,e[a],0)>-1;);return a}},3880:e=>{var t=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return t.test(e)}},6024:e=>{e.exports=function(e,t,a){for(var n=a-1,o=e.length;++n<o;)if(e[n]===t)return n;return-1}},8435:(e,t,a)=>{var n=a(217),o=a(3880),r=a(3344);e.exports=function(e){return o(e)?r(e):n(e)}},2153:e=>{var t=/\s/;e.exports=function(e){for(var a=e.length;a--&&t.test(e.charAt(a)););return a}},3344:e=>{var t="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",a="\\ud83c[\\udffb-\\udfff]",n="[^\\ud800-\\udfff]",o="(?:\\ud83c[\\udde6-\\uddff]){2}",r="[\\ud800-\\udbff][\\udc00-\\udfff]",l="(?:"+t+"|"+a+")?",u="[\\ufe0e\\ufe0f]?",i=u+l+"(?:\\u200d(?:"+[n,o,r].join("|")+")"+u+l+")*",s="(?:"+[n+t+"?",t,o,r,"[\\ud800-\\udfff]"].join("|")+")",d=RegExp(a+"(?="+a+")|"+s+i,"g");e.exports=function(e){return e.match(d)||[]}},5455:(e,t,a)=>{var n=a(6411),o=a(940),r=a(9631),l=a(6152),u=a(7878),i=a(3226),s=a(6001),d=a(7598),c=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(u(e)&&(l(e)||"string"==typeof e||"function"==typeof e.splice||i(e)||d(e)||r(e)))return!e.length;var t=o(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(s(e))return!n(e).length;for(var a in e)if(c.call(e,a))return!1;return!0}},4795:(e,t,a)=>{var n=a(3366),o=a(5125);e.exports=function(e){return"symbol"==typeof e||o(e)&&"[object Symbol]"==n(e)}},6188:(e,t,a)=>{var n=a(1054);e.exports=function(e){return null==e?"":n(e)}},5648:(e,t,a)=>{var n=a(1054),o=a(1704),r=a(3895),l=a(768),u=a(1821),i=a(8435),s=a(6188);e.exports=function(e,t,a){if((e=s(e))&&(a||void 0===t))return o(e);if(!e||!(t=n(t)))return e;var d=i(e),c=i(t),p=u(d,c),m=l(d,c)+1;return r(d,p,m).join("")}},1060:(e,t,a)=>{"use strict";a(223);var n=a(225),o=a(4825),r=a(243),l=a(9850),u=a.n(l),i=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function l(e){try{i(n.next(e))}catch(e){r(e)}}function u(e){try{i(n.throw(e))}catch(e){r(e)}}function i(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,u)}i((n=n.apply(e,t||[])).next())}))};const s=nodecg.Replicant("tournamentData"),d=nodecg.Replicant("roundStore"),c=nodecg.Replicant("matchStore"),p=[s,d,c],m=(0,r.MT)({state:{tournamentData:null,roundStore:null,matchStore:null},mutations:{setState(e,{name:t,val:a}){this.state[t]=u()(a)}},actions:{getTournamentData(e,{method:t,id:a}){return i(this,void 0,void 0,(function*(){return yield nodecg.sendMessage("getTournamentData",{method:t,id:a})}))},getSmashggEvent(e,{eventId:t}){return i(this,void 0,void 0,(function*(){return yield nodecg.sendMessage("getSmashggEvent",{eventId:t})}))},uploadTeamData(e,{file:t}){return i(this,void 0,void 0,(function*(){return f("teams",t)}))},uploadRoundData(e,{file:t}){return i(this,void 0,void 0,(function*(){return f("rounds",t)}))},fetchRoundData(e,{url:t}){return i(this,void 0,void 0,(function*(){return nodecg.sendMessage("getRounds",{url:t})}))},updateRound(e,t){return i(this,void 0,void 0,(function*(){return nodecg.sendMessage("updateRoundStore",t)}))},resetRoundStore(){nodecg.sendMessage("resetRoundStore")},setTeamImageHidden:(e,{teamId:t,isVisible:a})=>nodecg.sendMessage("toggleTeamImage",{teamId:t,isVisible:a}),removeRound:(e,{roundId:t})=>nodecg.sendMessage("removeRound",{roundId:t}),setShortName(e,t){s.value.meta.shortName=t}}});function f(e,t){return i(this,void 0,void 0,(function*(){const a=new FormData;a.append("file",t),a.append("jsonType",e);const n=yield fetch("/ipl-overlay-controls/upload-tournament-json",{method:"POST",body:a});if(200!==n.status){const e=yield n.text();throw new Error(`Import failed with status ${n.status}: ${e}`)}}))}const v=Symbol();function h(){return(0,r.oR)(v)}var g=a(7875),b=a(349);const S=e=>((0,g.dD)("data-v-c6c53654"),e=e(),(0,g.Cn)(),e),y=S((()=>(0,g._)("div",{class:"title"},"Tournament data",-1))),I={class:"layout horizontal center-horizontal"},w={class:"existing-data m-t-8"},x=S((()=>(0,g._)("div",{class:"title"},"Saved data",-1))),U=["href"],D={key:1},V={class:"badge badge-blue m-l-6"},F=S((()=>(0,g._)("br",null,null,-1))),k=S((()=>(0,g._)("br",null,null,-1)));var T,O=a(641),N=a(5455),M=a.n(N);!function(e){e.BATTLEFY="BATTLEFY",e.SMASHGG="SMASHGG",e.UPLOAD="UPLOAD",e.UNKNOWN="UNKNOWN"}(T||(T={}));class E{static toPrettyString(e){return{[T.BATTLEFY]:"Battlefy",[T.SMASHGG]:"Smash.gg",[T.UPLOAD]:"Uploaded file",[T.UNKNOWN]:"Unknown"}[e]}}var j=a(8127);function A(e,t,...a){const n=(0,O.qj)({isValid:null});return(0,g.YP)(e,(e=>{for(let t=0;t<a.length;t++){const o=a[t](e);if(!o.isValid){n.isValid=!1,n.message=o.message;break}n.isValid=!0,n.message=null}}),{immediate:t}),n}var C=a(5648),R=a.n(C);const W=e=>({isValid:""!==R()(e),message:"Must not be blank"});function P(e,t,a){var n;return`${n=t,new Intl.NumberFormat("en-US").format(n)} ${function(e,t,a){return 1===t?e:a?`${a}`:`${e}s`}(e,t,a)}`}var H=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function l(e){try{i(n.next(e))}catch(e){r(e)}}function u(e){try{i(n.throw(e))}catch(e){r(e)}}function i(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,u)}i((n=n.apply(e,t||[])).next())}))};const L=(0,g.aZ)({name:"TeamDataImporter",components:{IplCheckbox:j.IplCheckbox,IplUpload:j.IplUpload,IplButton:j.IplButton,IplInput:j.IplInput,IplSelect:j.IplSelect,IplSpace:j.IplSpace},setup(){const e=h(),t=(0,O.Fl)((()=>{var e;return!M()(null===(e=nodecg.bundleConfig.smashgg)||void 0===e?void 0:e.apiKey)})),a=(0,O.iH)([]),n=(0,O.iH)(T.BATTLEFY),o=(0,O.iH)(""),r=(0,O.iH)(""),l=(0,O.iH)(null),u=(0,O.iH)(!1),i=(0,O.iH)(""),s=A(i,!1,W);e.watch((e=>e.tournamentData.meta.shortName),(e=>i.value=e),{immediate:!0});const d={"tournament-id-input":A(o,!1,W)};return(0,j.provideValidators)(Object.assign(Object.assign({},d),{shortName:s})),{teamDataFile:l,useFileUpload:u,tournamentMetadata:(0,O.Fl)((()=>e.state.tournamentData.meta)),dataSourceOptions:(0,O.Fl)((()=>{const e=[T.BATTLEFY,T.UPLOAD];return t.value&&e.splice(1,0,T.SMASHGG),e.map((e=>({value:e,name:E.toPrettyString(e)})))})),dataSource:n,getDataSourceName:e=>E.toPrettyString(e),idLabel:(0,O.Fl)((()=>{switch(n.value){case T.BATTLEFY:return"Tournament URL";case T.SMASHGG:return"Tournament Slug";case T.UPLOAD:return"Data URL";default:throw new Error(`Unknown tournament data source '${n.value}'`)}})),handleImport(){var t;return H(this,void 0,void 0,(function*(){if(n.value===T.UPLOAD&&u.value)return e.dispatch("uploadTeamData",{file:l.value});{const l=n.value===T.BATTLEFY?function(e){if(e.includes("/")){const t=/^http(s?):\/\//.test(e)?5:3;return e.split("/")[t]}return e}(o.value):o.value,u=yield e.dispatch("getTournamentData",{method:n.value,id:l});(null===(t=null==u?void 0:u.events)||void 0===t?void 0:t.length)>1?(a.value=u.events.map((e=>({name:`${e.name} (${e.game})`,value:e.id.toString()}))),r.value=u.events[0].id.toString()):a.value=[]}}))},handleSmashggEventImport(){return H(this,void 0,void 0,(function*(){yield e.dispatch("getSmashggEvent",{eventId:parseInt(r.value)}),a.value=[]}))},handleSmashggImportCancel(){a.value=[]},allValid:(0,O.Fl)((()=>function(e){return Object.values(e).every((e=>e.isValid))}(d)||u.value&&!!l.value)),tournamentId:o,smashggEvents:a,smashggEvent:r,TournamentDataSource:T,shortName:i,shortNameValidator:s,shortNameChanged:(0,O.Fl)((()=>e.state.tournamentData.meta.shortName!==i.value)),updateShortName(){e.dispatch("setShortName",i.value)}}}});var _=a(6062),z=a.n(_),B=a(4460);z()(B.Z,{insert:"head",singleton:!1}),B.Z.locals;var G=a(4407);const Y=(0,G.Z)(L,[["render",function(e,t,a,n,r,l){const u=(0,g.up)("ipl-select"),i=(0,g.up)("ipl-button"),s=(0,g.up)("ipl-input"),d=(0,g.up)("ipl-upload"),c=(0,g.up)("ipl-checkbox"),p=(0,g.up)("ipl-space");return(0,g.wg)(),(0,g.j4)(p,null,{default:(0,g.w5)((()=>{var a,n;return[y,e.smashggEvents.length>1?((0,g.wg)(),(0,g.iD)(g.HY,{key:0},[(0,g.Wm)(u,{modelValue:e.smashggEvent,"onUpdate:modelValue":t[0]||(t[0]=t=>e.smashggEvent=t),options:e.smashggEvents,"data-test":"smashgg-event-selector",label:"Event"},null,8,["modelValue","options"]),(0,g.Wm)(i,{class:"m-t-8",label:"Import",async:"","progress-message":"Importing...","data-test":"smashgg-event-import-button",onClick:e.handleSmashggEventImport},null,8,["onClick"]),(0,g.Wm)(i,{class:"m-t-8",label:"Cancel",color:"red","data-test":"smashgg-event-import-cancel-button",onClick:e.handleSmashggImportCancel},null,8,["onClick"])],64)):((0,g.wg)(),(0,g.iD)(g.HY,{key:1},[(0,g.Wm)(u,{modelValue:e.dataSource,"onUpdate:modelValue":t[1]||(t[1]=t=>e.dataSource=t),label:"Source","data-test":"source-selector",options:e.dataSourceOptions},null,8,["modelValue","options"]),(0,g.wy)((0,g.Wm)(s,{modelValue:e.tournamentId,"onUpdate:modelValue":t[2]||(t[2]=t=>e.tournamentId=t),label:e.idLabel,name:"tournament-id-input",class:"m-t-4"},null,8,["modelValue","label"]),[[o.F8,e.dataSource!==e.TournamentDataSource.UPLOAD||!e.useFileUpload]]),(0,g.wy)((0,g.Wm)(d,{modelValue:e.teamDataFile,"onUpdate:modelValue":t[3]||(t[3]=t=>e.teamDataFile=t),class:"m-t-8","data-test":"team-data-upload"},null,8,["modelValue"]),[[o.F8,e.dataSource===e.TournamentDataSource.UPLOAD&&e.useFileUpload]]),(0,g._)("div",I,[(0,g.wy)((0,g.Wm)(c,{modelValue:e.useFileUpload,"onUpdate:modelValue":t[4]||(t[4]=t=>e.useFileUpload=t),label:"Upload file",class:"m-t-8",small:"","data-test":"use-file-upload-checkbox"},null,8,["modelValue"]),[[o.F8,e.dataSource===e.TournamentDataSource.UPLOAD]])]),(0,g.Wm)(i,{class:"m-t-8",label:"Import",disabled:!e.allValid,async:"","progress-message":"Importing...","data-test":"import-button",onClick:e.handleImport},null,8,["disabled","onClick"])],64)),(0,g._)("div",w,[x,e.tournamentMetadata.url?((0,g.wg)(),(0,g.iD)("a",{key:0,href:e.tournamentMetadata.url,target:"_blank"},(0,b.zw)(null!==(a=e.tournamentMetadata.name)&&void 0!==a?a:"No name"),9,U)):((0,g.wg)(),(0,g.iD)("span",D,(0,b.zw)(null!==(n=e.tournamentMetadata.name)&&void 0!==n?n:"No name"),1)),(0,g._)("span",V,(0,b.zw)(e.getDataSourceName(e.tournamentMetadata.source)),1),F,(0,g.Uk)(" "+(0,b.zw)(e.tournamentMetadata.id)+" ",1),e.tournamentMetadata.source===e.TournamentDataSource.SMASHGG?((0,g.wg)(),(0,g.iD)(g.HY,{key:2},[k,(0,g.Uk)(" "+(0,b.zw)(e.tournamentMetadata.sourceSpecificData.smashgg.eventData.name)+" ("+(0,b.zw)(e.tournamentMetadata.sourceSpecificData.smashgg.eventData.game)+") ",1)],64)):(0,g.kq)("",!0)]),(0,g.Wm)(s,{modelValue:e.shortName,"onUpdate:modelValue":t[5]||(t[5]=t=>e.shortName=t),label:"Short tournament name",name:"shortName",class:"m-t-4"},null,8,["modelValue"]),(0,g.Wm)(i,{class:"m-t-8",label:"Update","data-test":"update-short-name-button",color:e.shortNameChanged?"red":"blue",disabled:!e.shortNameValidator.isValid,onClick:e.updateShortName},null,8,["color","disabled","onClick"])]})),_:1})}],["__scopeId","data-v-c6c53654"]]),Z=(0,g._)("div",{class:"title"},"Round data",-1),$={class:"layout horizontal center-horizontal"};const K=(0,g.aZ)({name:"RoundImporter",components:{IplUpload:j.IplUpload,IplButton:j.IplButton,IplCheckbox:j.IplCheckbox,IplInput:j.IplInput,IplSpace:j.IplSpace},setup(){const e=h(),t=(0,O.iH)(!1),a=(0,O.iH)(null),n=(0,O.iH)(null),o={"round-data-url":(0,j.validator)(n,!1,W)};return(0,j.provideValidators)(o),{useFileUpload:t,roundFile:a,dataUrl:n,allValid:(0,O.Fl)((()=>(0,j.allValid)(o))),handleImport(){return o=this,r=void 0,u=function*(){t.value?yield e.dispatch("uploadRoundData",{file:a.value}):yield e.dispatch("fetchRoundData",{url:n.value})},new((l=void 0)||(l=Promise))((function(e,t){function a(e){try{i(u.next(e))}catch(e){t(e)}}function n(e){try{i(u.throw(e))}catch(e){t(e)}}function i(t){var o;t.done?e(t.value):(o=t.value,o instanceof l?o:new l((function(e){e(o)}))).then(a,n)}i((u=u.apply(o,r||[])).next())}));var o,r,l,u}}}}),q=(0,G.Z)(K,[["render",function(e,t,a,n,r,l){const u=(0,g.up)("ipl-input"),i=(0,g.up)("ipl-upload"),s=(0,g.up)("ipl-checkbox"),d=(0,g.up)("ipl-button"),c=(0,g.up)("ipl-space");return(0,g.wg)(),(0,g.j4)(c,null,{default:(0,g.w5)((()=>[Z,(0,g.wy)((0,g.Wm)(u,{modelValue:e.dataUrl,"onUpdate:modelValue":t[0]||(t[0]=t=>e.dataUrl=t),name:"round-data-url",label:"Data URL"},null,8,["modelValue"]),[[o.F8,!e.useFileUpload]]),(0,g.wy)((0,g.Wm)(i,{modelValue:e.roundFile,"onUpdate:modelValue":t[1]||(t[1]=t=>e.roundFile=t),"data-test":"round-file-upload"},null,8,["modelValue"]),[[o.F8,e.useFileUpload]]),(0,g._)("div",$,[(0,g.Wm)(s,{modelValue:e.useFileUpload,"onUpdate:modelValue":t[2]||(t[2]=t=>e.useFileUpload=t),small:"",class:"m-t-8",label:"Upload file","data-test":"use-file-upload-checkbox"},null,8,["modelValue"])]),(0,g.Wm)(d,{label:"Import",class:"m-t-8",async:"","progress-message":"Importing...","data-test":"import-button",disabled:!e.useFileUpload&&!e.allValid||e.useFileUpload&&!e.roundFile,onClick:e.handleImport},null,8,["disabled","onClick"])])),_:1})}]]);var J=a(6222);const Q=(0,g._)("div",{class:"title"},"Match data",-1),X={class:"text-small text-center"},ee=(0,g.aZ)({name:"MatchExporter",components:{IplButton:j.IplButton,IplSpace:j.IplSpace},setup(){const e=h();return{pluralize:P,matchCount:(0,O.Fl)((()=>Object.keys(e.state.matchStore).length)),bundleName:nodecg.bundleName}}}),te=(0,G.Z)(ee,[["render",function(e,t,a,n,o,r){const l=(0,g.up)("ipl-button"),u=(0,g.up)("ipl-space");return(0,g.wg)(),(0,g.j4)(u,null,{default:(0,g.w5)((()=>[Q,(0,g._)("div",X,"Storing data for "+(0,b.zw)(e.pluralize("match",e.matchCount,"matches")),1),(0,g.Wm)(l,{label:"Export",class:"m-t-4",href:`/${e.bundleName}/match-data`},null,8,["href"])])),_:1})}]]),ae=(0,g.aZ)({name:"DataImport",components:{MatchExporter:te,IplErrorDisplay:J.Z,RoundImporter:q,TeamDataImporter:Y}}),ne=(0,G.Z)(ae,[["render",function(e,t,a,n,o,r){const l=(0,g.up)("ipl-error-display"),u=(0,g.up)("team-data-importer"),i=(0,g.up)("round-importer"),s=(0,g.up)("match-exporter");return(0,g.wg)(),(0,g.iD)(g.HY,null,[(0,g.Wm)(l,{class:"m-b-8"}),(0,g.Wm)(u),(0,g.Wm)(i,{class:"m-t-8"}),(0,g.Wm)(s,{class:"m-t-8"})],64)}]]);var oe=a(4928);(0,n.r)(p,m).then((()=>{const e=(0,o.ri)(ne);(0,oe.EW)(e),e.use(m,v),e.mount("#app")}))}},a={};function n(e){var o=a[e];if(void 0!==o)return o.exports;var r=a[e]={id:e,loaded:!1,exports:{}};return t[e](r,r.exports,n),r.loaded=!0,r.exports}n.m=t,e=[],n.O=(t,a,o,r)=>{if(!a){var l=1/0;for(d=0;d<e.length;d++){for(var[a,o,r]=e[d],u=!0,i=0;i<a.length;i++)(!1&r||l>=r)&&Object.keys(n.O).every((e=>n.O[e](a[i])))?a.splice(i--,1):(u=!1,r<l&&(l=r));if(u){e.splice(d--,1);var s=o();void 0!==s&&(t=s)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[a,o,r]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={475:0};n.O.j=t=>0===e[t];var t=(t,a)=>{var o,r,[l,u,i]=a,s=0;if(l.some((t=>0!==e[t]))){for(o in u)n.o(u,o)&&(n.m[o]=u[o]);if(i)var d=i(n)}for(t&&t(a);s<l.length;s++)r=l[s],n.o(e,r)&&e[r]&&e[r][0](),e[l[s]]=0;return n.O(d)},a=self.webpackChunk=self.webpackChunk||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var o=n.O(void 0,[36],(()=>n(1060)));o=n.O(o)})();