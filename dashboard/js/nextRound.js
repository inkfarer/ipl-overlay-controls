(()=>{"use strict";var e,t={2298:(e,t,a)=>{a(223);var n=a(225),o=a(7875),d=a(349);const l={class:"layout horizontal"},s={class:"layout vertical center-horizontal max-width"},u={class:"layout vertical center-horizontal max-width m-l-8"},r={class:"layout horizontal center-horizontal"};var i=a(641),m=a(8127),c=a(243),p=a(9850),v=a.n(p),h=function(e,t,a,n){return new(a||(a=Promise))((function(o,d){function l(e){try{u(n.next(e))}catch(e){d(e)}}function s(e){try{u(n.throw(e))}catch(e){d(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,s)}u((n=n.apply(e,t||[])).next())}))};const g=[nodecg.Replicant("tournamentData"),nodecg.Replicant("roundStore")],f=(0,c.MT)({state:{tournamentData:null,roundStore:null},mutations:{setState(e,{name:t,val:a}){this.state[t]=v()(a)}},actions:{getTournamentData(e,{method:t,id:a}){return h(this,void 0,void 0,(function*(){return yield nodecg.sendMessage("getTournamentData",{method:t,id:a})}))},getSmashggEvent(e,{eventId:t}){return h(this,void 0,void 0,(function*(){return yield nodecg.sendMessage("getSmashggEvent",{eventId:t})}))},uploadTeamData(e,{file:t}){return h(this,void 0,void 0,(function*(){return b("teams",t)}))},uploadRoundData(e,{file:t}){return h(this,void 0,void 0,(function*(){return b("rounds",t)}))},fetchRoundData(e,{url:t}){return h(this,void 0,void 0,(function*(){return nodecg.sendMessage("getRounds",{url:t})}))},updateRound(e,t){return h(this,void 0,void 0,(function*(){return nodecg.sendMessage("updateRoundStore",t)}))},resetRoundStore(){nodecg.sendMessage("resetRoundStore")},setTeamImageHidden:(e,{teamId:t,isVisible:a})=>nodecg.sendMessage("toggleTeamImage",{teamId:t,isVisible:a}),removeRound:(e,{roundId:t})=>nodecg.sendMessage("removeRound",{roundId:t})}});function b(e,t){return h(this,void 0,void 0,(function*(){const a=new FormData;a.append("file",t),a.append("jsonType",e);const n=yield fetch("/ipl-overlay-controls/upload-tournament-json",{method:"POST",body:a});if(200!==n.status){const e=yield n.text();throw new Error(`Import failed with status ${n.status}: ${e}`)}}))}const w=Symbol(),I=nodecg.Replicant("nextRound"),x=[I],y=(0,c.MT)({state:{nextRound:null},mutations:{setState(e,{name:t,val:a}){this.state[t]=v()(a)},setShowOnStream(e,t){I.value.showOnStream=t}},actions:{beginNextMatch(){nodecg.sendMessage("beginNextMatch")},setNextRound(e,{teamAId:t,teamBId:a,roundId:n}){nodecg.sendMessage("setNextRound",{teamAId:t,teamBId:a,roundId:n})}}}),S=Symbol();var R=a(908),B=a(2121);const O=(0,o.aZ)({name:"NextRound",components:{IplErrorDisplay:B.Z,IplMessage:m.IplMessage,IplButton:m.IplButton,IplCheckbox:m.IplCheckbox,IplSelect:m.IplSelect,IplSpace:m.IplSpace},setup(){const e=(0,c.oR)(w),t=(0,c.oR)(S),a=(0,i.iH)(""),n=(0,i.iH)(""),d=(0,i.iH)(""),l=(0,i.Fl)((()=>a.value!==t.state.nextRound.teamA.id||n.value!==t.state.nextRound.teamB.id||d.value!==t.state.nextRound.round.id)),s=(0,i.Fl)((()=>e.state.roundStore[d.value])),u=(0,i.Fl)((()=>{var e,t;return(null===(e=s.value.teamA)||void 0===e?void 0:e.score)>0||(null===(t=s.value.teamB)||void 0===t?void 0:t.score)>0}));return t.watch((e=>e.nextRound.teamA.id),(e=>a.value=e),{immediate:!0}),t.watch((e=>e.nextRound.teamB.id),(e=>n.value=e),{immediate:!0}),t.watch((e=>e.nextRound.round.id),(e=>d.value=e),{immediate:!0}),(0,o.YP)(d,(()=>{u.value?(a.value=s.value.teamA.id,n.value=s.value.teamB.id):(a.value=t.state.nextRound.teamA.id,n.value=t.state.nextRound.teamB.id)})),{teams:(0,i.Fl)((()=>e.state.tournamentData.teams.map((e=>({value:e.id,name:(0,R.f)(e.name)}))))),rounds:(0,i.Fl)((()=>Object.entries(e.state.roundStore).map((([e,t])=>({value:e,name:t.meta.name}))))),teamAId:a,teamBId:n,roundId:d,teamAImageShown:(0,i.Fl)({get:()=>t.state.nextRound.teamA.showLogo,set(a){e.dispatch("setTeamImageHidden",{teamId:t.state.nextRound.teamA.id,isVisible:a})}}),teamBImageShown:(0,i.Fl)({get:()=>t.state.nextRound.teamB.showLogo,set(a){e.dispatch("setTeamImageHidden",{teamId:t.state.nextRound.teamB.id,isVisible:a})}}),updateButtonColor:(0,i.Fl)((()=>l.value?"red":"blue")),handleUpdate(){t.dispatch("setNextRound",{teamAId:a.value,teamBId:n.value,roundId:d.value})},beginNextMatch(){t.dispatch("beginNextMatch")},showOnStream:(0,i.Fl)({get:()=>t.state.nextRound.showOnStream,set(e){t.commit("setShowOnStream",e)}}),selectedRound:s,roundHasProgress:u,addDots:R.f}}}),V=(0,a(4407).Z)(O,[["render",function(e,t,a,n,i,m){const c=(0,o.up)("ipl-error-display"),p=(0,o.up)("ipl-message"),v=(0,o.up)("ipl-select"),h=(0,o.up)("ipl-checkbox"),g=(0,o.up)("ipl-button"),f=(0,o.up)("ipl-space");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(c,{class:"m-b-8"}),e.roundHasProgress?((0,o.wg)(),(0,o.j4)(p,{key:0,type:"info","data-test":"round-progress-message",class:"m-b-8"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,d.zw)(e.selectedRound.meta.isCompleted?`'${e.selectedRound.meta.name}' is already completed.`:`'${e.selectedRound.meta.name}' already has saved progress.`)+" "+(0,d.zw)(`(${e.addDots(e.selectedRound.teamA.name)} vs ${e.addDots(e.selectedRound.teamB.name)})`),1)])),_:1})):(0,o.kq)("",!0),(0,o.Wm)(f,null,{default:(0,o.w5)((()=>[(0,o._)("div",l,[(0,o._)("div",s,[(0,o.Wm)(v,{modelValue:e.teamAId,"onUpdate:modelValue":t[0]||(t[0]=t=>e.teamAId=t),label:"Team A","data-test":"team-a-selector",options:e.teams},null,8,["modelValue","options"]),(0,o.Wm)(h,{modelValue:e.teamAImageShown,"onUpdate:modelValue":t[1]||(t[1]=t=>e.teamAImageShown=t),class:"m-t-6",label:"Show image","data-test":"team-a-image-toggle",small:""},null,8,["modelValue"])]),(0,o._)("div",u,[(0,o.Wm)(v,{modelValue:e.teamBId,"onUpdate:modelValue":t[2]||(t[2]=t=>e.teamBId=t),label:"Team B","data-test":"team-b-selector",options:e.teams},null,8,["modelValue","options"]),(0,o.Wm)(h,{modelValue:e.teamBImageShown,"onUpdate:modelValue":t[3]||(t[3]=t=>e.teamBImageShown=t),class:"m-t-6",label:"Show image","data-test":"team-b-image-toggle",small:""},null,8,["modelValue"])])]),(0,o.Wm)(v,{modelValue:e.roundId,"onUpdate:modelValue":t[4]||(t[4]=t=>e.roundId=t),class:"m-t-6",options:e.rounds,"data-test":"round-selector",label:"Round"},null,8,["modelValue","options"]),(0,o.Wm)(g,{label:"Update",class:"m-t-8",color:e.updateButtonColor,"data-test":"update-next-round-button",onClick:e.handleUpdate},null,8,["color","onClick"]),(0,o.Wm)(g,{label:"Begin next match",color:"red",class:"m-t-8","requires-confirmation":"","data-test":"begin-next-match-button",onClick:e.beginNextMatch},null,8,["onClick"]),(0,o._)("div",r,[(0,o.Wm)(h,{modelValue:e.showOnStream,"onUpdate:modelValue":t[5]||(t[5]=t=>e.showOnStream=t),class:"m-t-8",label:"Show on stream","data-test":"show-on-stream-toggle"},null,8,["modelValue"])])])),_:1})],64)}]]);var M,A,T=a(4825),k=a(4928);A=function*(){yield(0,n.r)(g,f),yield(0,n.r)(x,y);const e=(0,T.ri)(V);(0,k.EW)(e),e.use(f,w),e.use(y,S),e.mount("#app")},new((M=void 0)||(M=Promise))((function(e,t){function a(e){try{o(A.next(e))}catch(e){t(e)}}function n(e){try{o(A.throw(e))}catch(e){t(e)}}function o(t){var o;t.done?e(t.value):(o=t.value,o instanceof M?o:new M((function(e){e(o)}))).then(a,n)}o((A=A.apply(void 0,[])).next())}))}},a={};function n(e){var o=a[e];if(void 0!==o)return o.exports;var d=a[e]={id:e,loaded:!1,exports:{}};return t[e](d,d.exports,n),d.loaded=!0,d.exports}n.m=t,e=[],n.O=(t,a,o,d)=>{if(!a){var l=1/0;for(i=0;i<e.length;i++){for(var[a,o,d]=e[i],s=!0,u=0;u<a.length;u++)(!1&d||l>=d)&&Object.keys(n.O).every((e=>n.O[e](a[u])))?a.splice(u--,1):(s=!1,d<l&&(l=d));if(s){e.splice(i--,1);var r=o();void 0!==r&&(t=r)}}return t}d=d||0;for(var i=e.length;i>0&&e[i-1][2]>d;i--)e[i]=e[i-1];e[i]=[a,o,d]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={814:0};n.O.j=t=>0===e[t];var t=(t,a)=>{var o,d,[l,s,u]=a,r=0;if(l.some((t=>0!==e[t]))){for(o in s)n.o(s,o)&&(n.m[o]=s[o]);if(u)var i=u(n)}for(t&&t(a);r<l.length;r++)d=l[r],n.o(e,d)&&e[d]&&e[d][0](),e[l[r]]=0;return n.O(i)},a=self.webpackChunk=self.webpackChunk||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var o=n.O(void 0,[498],(()=>n(2298)));o=n.O(o)})();